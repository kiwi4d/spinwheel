<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lucky Spin KIWI4D</title>
  <style>
    * {
      box-sizing: border-box;
    }
    body, html {
      margin: 0; padding: 0; height: 100%;
      font-family: Arial, sans-serif;
      background: url('https://i.imgur.com/9V6HzWt.jpg') no-repeat center center fixed;
      background-size: cover;
      color: white;
      overflow: hidden;
      position: relative;
    }
    /* Popup */
    #popup, #resultPopup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      color: #333;
      padding: 30px;
      width: 400px;
      border-radius: 8px;
      box-shadow: 0 0 20px rgba(0,0,0,0.5);
      text-align: center;
      z-index: 20;
      display: none;
    }
    #popup.show, #resultPopup.show {
      display: block;
    }
    #popup h2, #resultPopup h2 {
      margin-top: 0;
      font-size: 24px;
    }
    #popup p, #resultPopup p {
      font-size: 16px;
      line-height: 1.4;
    }
    #popup button, #resultPopup button {
      margin-top: 20px;
      background-color: #cba032;
      border: none;
      padding: 10px 25px;
      font-weight: bold;
      color: white;
      cursor: pointer;
      border-radius: 4px;
      font-size: 16px;
    }
    /* Form container (kanan atas) */
    .form-container {
      position: fixed;
      top: 70px;
      right: 50px;
      width: 300px;
      z-index: 10;
      text-align: center;
      background: rgba(0,0,0,0.6);
      padding: 20px;
      border-radius: 10px;
    }
    .form-container img {
      width: 180px;
      margin-bottom: 15px;
    }
    .form-container label {
      display: block;
      margin-bottom: 8px;
      font-weight: normal;
      font-size: 18px;
      color: white;
      text-align: left;
    }
    .form-container input[type="text"] {
      width: 100%;
      padding: 10px;
      margin-bottom: 12px;
      border: none;
      border-radius: 6px;
      font-size: 14px;
    }
    .btn {
      width: 140px;
      padding: 10px 0;
      margin: 5px 8px;
      font-weight: bold;
      font-size: 14px;
      border: none;
      border-radius: 20px;
      cursor: pointer;
      color: white;
      display: inline-block;
      user-select: none;
      transition: background-color 0.3s ease;
    }
    .btn-gold {
      background-color: #b8860b;
    }
    .btn-gold:hover {
      background-color: #d4af37;
    }
    .btn-blue {
      background-color: #0077b6;
    }
    .btn-blue:hover {
      background-color: #0096c7;
    }
    #spinButton {
      width: 100%;
      margin-top: 15px;
      background-color: #0077b6;
      border-radius: 25px;
      font-size: 18px;
      font-weight: bold;
    }
    #spinButton:disabled {
      background-color: gray;
      cursor: not-allowed;
    }
    /* Spin wheel container */
    #wheel-container {
      position: fixed;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      z-index: 15;
      width: 400px;
      height: 400px;
      user-select: none;
    }
    #wheel {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      border: 10px solid #cba032;
      box-shadow: 0 0 15px gold;
      transition: transform 5s cubic-bezier(0.33, 1, 0.68, 1);
    }
    /* Pointer */
    #pointer {
      position: fixed;
      left: 50%;
      top: calc(50% - 220px);
      width: 0;
      height: 0;
      border-left: 25px solid transparent;
      border-right: 25px solid transparent;
      border-bottom: 40px solid #cba032;
      transform: translateX(-50%);
      z-index: 20;
      filter: drop-shadow(0 0 5px gold);
    }
  </style>
</head>
<body>

  <!-- Popup welcome -->
  <div id="popup" class="show">
    <h2>Selamat Datang di Lucky Spin Wheels!!!</h2>
    <p>
      Kami selaku pihak Lucky Spin Wheels terlebih dahulu mengucapkan selamat kepada setiap member yang memiliki tiket untuk berkesempatan memenangkan hadiah menarik yang ditawarkan di Lucky Spin Wheels Lucky Spin ini. Untuk kalian yang memiliki tiket silahkan masukkan ke kolom kode yang disediakan dan klik tombol spin untuk memulai peruntungan anda..!!!
    </p>
    <button onclick="document.getElementById('popup').classList.remove('show')">Thank You</button>
  </div>

  <!-- Popup hasil -->
  <div id="resultPopup">
    <h2>Selamat!</h2>
    <p id="resultText">Anda mendapatkan hadiah ...</p>
    <button onclick="document.getElementById('resultPopup').classList.remove('show')">Tutup</button>
  </div>

  <!-- Form kanan atas -->
  <div class="form-container">
    <img src="https://i.imgur.com/vcDzELV.png" alt="Logo KIWI4D" />
    <label for="username">Masukkan Username:</label>
    <input type="text" id="username" placeholder="username" />

    <label for="voucher">Masukkan Kode Voucher:</label>
    <input type="text" id="voucher" placeholder="voucher" />

    <button class="btn btn-blue" id="spinButton" disabled>SPIN</button>

    <div style="margin-top: 20px;">
      <button class="btn btn-gold" onclick="alert('Fitur Riwayat belum tersedia')">RIWAYAT</button>
      <button class="btn btn-gold" onclick="alert('Syarat & Ketentuan belum tersedia')">Syarat & Ketentuan</button>
    </div>
    <div>
      <button class="btn btn-blue" onclick="window.open('https://wa.me/82136893501','_blank')">Whatsapp Admin</button>
      <button class="btn btn-blue" onclick="window.location.href='https://semutmerah.site'">KEMBALI KE SITUS</button>
    </div>
  </div>

  <!-- Spin wheel & pointer -->
  <div id="wheel-container">
    <canvas id="wheel" width="400" height="400"></canvas>
  </div>
  <div id="pointer"></div>

<script>
  // Voucher & username validation
  const validVouchers = ["ABC123", "KIWI2025", "LUCKY50", "SPINWIN", "VOUCHER99"];
  const voucherInput = document.getElementById("voucher");
  const usernameInput = document.getElementById("username");
  const spinButton = document.getElementById("spinButton");

  function validateInputs() {
    const voucherVal = voucherInput.value.trim().toUpperCase();
    const usernameVal = usernameInput.value.trim();

    if (usernameVal !== "" && validVouchers.includes(voucherVal)) {
      spinButton.disabled = false;
    } else {
      spinButton.disabled = true;
    }
  }
  voucherInput.addEventListener("input", validateInputs);
  usernameInput.addEventListener("input", validateInputs);

  // Spin wheel setup
  const wheelCanvas = document.getElementById('wheel');
  const ctx = wheelCanvas.getContext('2d');
  const segments = [
    { text: "Rp.5.000", color: "#f44336" },
    { text: "Rp.10.000", color: "#e91e63" },
    { text: "Rp.20.000", color: "#9c27b0" },
    { text: "Rp.25.000", color: "#673ab7" },
    { text: "Rp.50.000", color: "#3f51b5" },
    { text: "Rp.100.000", color: "#2196f3" },
    { text: "Iphone 16 PROMAX", color: "#03a9f4" },
    { text: "Motor NMAX", color: "#00bcd4" }
  ];
  const segmentCount = segments.length;
  const anglePerSegment = 2 * Math.PI / segmentCount;
  let currentAngle = 0;

  function drawWheel() {
    const radius = wheelCanvas.width / 2;
    ctx.clearRect(0, 0, wheelCanvas.width, wheelCanvas.height);
    ctx.save();
    ctx.translate(radius, radius);
    ctx.rotate(currentAngle);

    for(let i = 0; i < segmentCount; i++) {
      // Draw segment
      ctx.beginPath();
      ctx.fillStyle = segments[i].color;
      ctx.moveTo(0, 0);
      ctx.arc(0, 0, radius, i * anglePerSegment, (i + 1) * anglePerSegment);
      ctx.lineTo(0,0);
      ctx.fill();

      // Draw text
      ctx.save();
      ctx.fillStyle = 'white';
      ctx.font = "bold 16px Arial";
      ctx.textAlign = "right";
      ctx.textBaseline = "middle";
      let textAngle = (i + 0.5) * anglePerSegment;
      ctx.rotate(textAngle);
      ctx.fillText(segments[i].text, radius - 10, 0);
      ctx.restore();
    }
    ctx.restore();
  }
  drawWheel();

  // Spin logic
  spinButton.addEventListener("click", () => {
    spinButton.disabled = true;

    // Putar setidaknya 3-5 putaran + hasil acak
    let randomSegmentIndex = Math.floor(Math.random() * segmentCount);
    let spins = 5; // Putaran penuh
    let finalAngle = (2 * Math.PI * spins) + (randomSegmentIndex * anglePerSegment) + anglePerSegment / 2;

    // Animasi putar
    let start = null;
    const duration = 5000; // 5 detik

    function animate(timestamp) {
      if (!start) start = timestamp;
      let elapsed = timestamp - start;
      let progress = Math.min(elapsed / duration, 1);
      // easing cubic out
      let easeProgress = 1 - Math.pow(1 - progress, 3);

      currentAngle = easeProgress * finalAngle;
      drawWheel();

      if(progress < 1) {
        requestAnimationFrame(animate);
      } else {
        // Selesai putar
        showResult(randomSegmentIndex);
        spinButton.disabled = false;
      }
    }
    requestAnimationFrame(animate);
  });

  function showResult(index) {
    const resultText = document.getElementById('resultText');
    resultText.textContent = `Anda mendapatkan hadiah: ${segments[index].text}`;
    document.getElementById('resultPopup').classList.add('show');
  }
</script>

</body>
</html>
